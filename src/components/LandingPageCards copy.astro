---
import TagLineChanger from './TagLineChanger.astro';
import { baseHost } from '../utils/utilities.ts';
---

<!--
/assets/img/2024/media/photos/215/p1050236_1jpg_1804387999_o_large.jpg
/assets/img/2024/media/photos/249/dsc_7155_1jpg_1857566648_o_large.jpg
/assets/img/2024/media/photos/267/dsc_9041-copy_3994582679_o_large.jpg
/assets/img/2024/media/photos/191/p1050284_1jpg_1804426377_o_large.jpg
/assets/img/2024/media/photos/187/p1020923_1jpg_440526301_o_large.jpg
/assets/img/2024/media/photos/628/dsc_0271-copy_8276649619_o_large.jpg
/assets/img/2024/media/photos/514/dsc_5724_4729434512_o_large.jpg
/assets/img/2024/media/photos/509/dsc_5794_4728799397_o_large.jpg
/assets/img/2024/media/photos/497/dsc_9879_copy_8695908244_o_large.jpg
/assets/img/2024/media/photos/474/dsc_1625-copy_8163702849_o_large.jpg
/assets/img/2024/media/photos/470/dsc_0122_7625831368_o_large.jpg
/assets/img/2024/media/photos/471/dsc_0261-copy_7346674726_o_large.jpg
/assets/img/2024/media/photos/453/dsc_0126_7625832570_o_large.jpg
/assets/img/2024/media/photos/407/dsc01492-copy_14669118309_o_large.jpg
/assets/img/2024/media/photos/387/dsc01499-copy_14853273134_o_large.jpg
/assets/img/2024/media/photos/337/dsc_8983-copy_3995397692_o_large.jpg
/assets/img/2024/media/photos/299/dsc_8950-copy_3995432090_o_large.jpg
/assets/img/2024/media/photos/1170/DSC_0105_copy_large.jpg
/assets/img/2024/media/photos/1153/DSC_0123_copy_large.jpg
/assets/img/2024/media/photos/762/dsc_5861_4728803447_o_large.jpg
/assets/img/2024/media/photos/821/dsc_0017_7625856512_o_large.jpg
/assets/img/2024/media/photos/652/dsc_1640-copy_8163742640_o_large.jpg
/assets/img/2024/media/photos/642/iiyama-autumn-bike_8187292286_o_large.jpg
 -->
<div class="landing-page-cards" data-base-host={baseHost}>
    <div class="info-item">
        <img
            src=`${ baseHost }/assets/img/2024/media/photos/2332/dsc_2439_8219834753_o_large.jpg`
            alt="Beyond the Golden Route"
            class="info-image"
        />
        <h2><TagLineChanger /></h2>
        <p>
            Perhaps you’ve <span class="emph">already planned the Golden Route</span> - Kyoto, Tokyo, Osaka, maybe even Hakone,
            Takayama, and Kanazawa. These places are great, and <span class="emph"
                >there's a reason they’re crowd favorites</span
            >
            . But you’ve also wondered what it's like in <span class="emph">the places in between</span> - the quiet towns,
            the back roads, <span class="emph">the parts most travelers miss</span>.
        </p>
    </div>

    <div class="info-item">
        <img
            src=`${ baseHost }/assets/img/2024/media/photos/821/dsc_0017_7625856512_o_large.jpg`
            alt="Journey Through Rural Japan"
            class="info-image"
        />
        <h2>We Design Your Journey Through Rural Japan</h2>
        <p>
            <span class="emph first-words">We design flexible countryside itineraries</span> - by bike, on foot, or a mix
            of both - <span class="emph">tailored to your schedule, comfort, and curiosity</span>. Whether <span
                class="emph">fully guided or just planning and logistics</span
            >, we help turn the space between the famous stops into the <span class="emph">best part of the trip</span>.
        </p>
    </div>

    <div class="info-item">
        <img
            src=`${ baseHost }/assets/img/2024/media/photos/472/dsc_0014_7625855158_o_large.jpg`
            alt="Accessible Rural Japan"
            class="info-image"
        />
        <h2>Accessible Japan Countryside - Without a Car</h2>
        <p>
            Maybe you’ve been <span class="emph">told you need a car</span> to see the countryside, or to get "off the beaten
            path". <span class="emph">You don’t</span>. Many <span class="emph"
                >rural towns are eager and ready for visitors</span
            >, and more accessible than you think - <span class="emph"><em>if</em></span> you know <span class="emph"
                >where to go, how to get there</span
            > and you're willing to slow down.
        </p>
    </div>
</div>

<script is:inline client:load>
    document.addEventListener('DOMContentLoaded', () => {
        const container = document.querySelector('.landing-page-cards');
        const baseHost = container.dataset.baseHost;
        const cyclePaths = [
            '/assets/img/2024/media/photos/215/p1050236_1jpg_1804387999_o_large.jpg',
            '/assets/img/2024/media/photos/249/dsc_7155_1jpg_1857566648_o_large.jpg',
            '/assets/img/2024/media/photos/267/dsc_9041-copy_3994582679_o_large.jpg',
            '/assets/img/2024/media/photos/191/p1050284_1jpg_1804426377_o_large.jpg',
            '/assets/img/2024/media/photos/187/p1020923_1jpg_440526301_o_large.jpg',
            '/assets/img/2024/media/photos/628/dsc_0271-copy_8276649619_o_large.jpg',
            '/assets/img/2024/media/photos/514/dsc_5724_4729434512_o_large.jpg',
            '/assets/img/2024/media/photos/509/dsc_5794_4728799397_o_large.jpg',
            '/assets/img/2024/media/photos/497/dsc_9879_copy_8695908244_o_large.jpg',
            '/assets/img/2024/media/photos/474/dsc_1625-copy_8163702849_o_large.jpg',
            '/assets/img/2024/media/photos/470/dsc_0122_7625831368_o_large.jpg',
            '/assets/img/2024/media/photos/471/dsc_0261-copy_7346674726_o_large.jpg',
            '/assets/img/2024/media/photos/453/dsc_0126_7625832570_o_large.jpg',
            '/assets/img/2024/media/photos/407/dsc01492-copy_14669118309_o_large.jpg',
            '/assets/img/2024/media/photos/387/dsc01499-copy_14853273134_o_large.jpg',
            '/assets/img/2024/media/photos/337/dsc_8983-copy_3995397692_o_large.jpg',
            '/assets/img/2024/media/photos/299/dsc_8950-copy_3995432090_o_large.jpg',
            '/assets/img/2024/media/photos/1170/DSC_0105_copy_large.jpg',
            '/assets/img/2024/media/photos/1153/DSC_0123_copy_large.jpg',
            '/assets/img/2024/media/photos/762/dsc_5861_4728803447_o_large.jpg',
            '/assets/img/2024/media/photos/821/dsc_0017_7625856512_o_large.jpg',
            '/assets/img/2024/media/photos/652/dsc_1640-copy_8163742640_o_large.jpg',
            '/assets/img/2024/media/photos/642/iiyama-autumn-bike_8187292286_o_large.jpg',
        ];
        const cycleImages = cyclePaths.map((path) => baseHost + path);

        // fade logic
        function fadeToRandom(img) {
            let next;
            do {
                next = Math.floor(Math.random() * cycleImages.length);
            } while (next === img._cycleIndex);
            img._cycleIndex = next;
            const newSrc = cycleImages[next];

            // fade out
            img.style.opacity = 0;
            const onFade = (e) => {
                if (e.propertyName !== 'opacity') return;
                img.removeEventListener('transitionend', onFade);
                img.src = newSrc;
                requestAnimationFrame(() => (img.style.opacity = 1));
            };
            img.addEventListener('transitionend', onFade);
        }

        // initialize all images
        let interval = 10000;
        container.querySelectorAll('.info-image').forEach((img) => {
            img._cycleIndex = 0;
            img.style.transition = 'opacity 2s ease';
            img.style.opacity = 1;
            // auto‑fade every 6s
            setInterval(() => fadeToRandom(img), interval);
            //interval = interval + Math.random() * (14000 - 6000) + 6000;
        });
    });
</script>

<!-- 
<script is:inline>
    document.addEventListener('DOMContentLoaded', () => {
        const container = document.querySelector('.landing-page-cards');
        const baseHost = container.dataset.baseHost; // now you've got it!
        // 1) list all the images you want to cycle through:
        const cyclePaths = [
            '/assets/img/2024/media/photos/215/p1050236_1jpg_1804387999_o_large.jpg',
            '/assets/img/2024/media/photos/249/dsc_7155_1jpg_1857566648_o_large.jpg',
            '/assets/img/2024/media/photos/267/dsc_9041-copy_3994582679_o_large.jpg',
            '/assets/img/2024/media/photos/191/p1050284_1jpg_1804426377_o_large.jpg',
            '/assets/img/2024/media/photos/187/p1020923_1jpg_440526301_o_large.jpg',
            '/assets/img/2024/media/photos/628/dsc_0271-copy_8276649619_o_large.jpg',
            '/assets/img/2024/media/photos/514/dsc_5724_4729434512_o_large.jpg',
            '/assets/img/2024/media/photos/509/dsc_5794_4728799397_o_large.jpg',
            '/assets/img/2024/media/photos/497/dsc_9879_copy_8695908244_o_large.jpg',
            '/assets/img/2024/media/photos/474/dsc_1625-copy_8163702849_o_large.jpg',
            '/assets/img/2024/media/photos/470/dsc_0122_7625831368_o_large.jpg',
            '/assets/img/2024/media/photos/471/dsc_0261-copy_7346674726_o_large.jpg',
            '/assets/img/2024/media/photos/453/dsc_0126_7625832570_o_large.jpg',
            '/assets/img/2024/media/photos/407/dsc01492-copy_14669118309_o_large.jpg',
            '/assets/img/2024/media/photos/387/dsc01499-copy_14853273134_o_large.jpg',
            '/assets/img/2024/media/photos/337/dsc_8983-copy_3995397692_o_large.jpg',
            '/assets/img/2024/media/photos/299/dsc_8950-copy_3995432090_o_large.jpg',
            '/assets/img/2024/media/photos/1170/DSC_0105_copy_large.jpg',
            '/assets/img/2024/media/photos/1153/DSC_0123_copy_large.jpg',
            '/assets/img/2024/media/photos/762/dsc_5861_4728803447_o_large.jpg',
            '/assets/img/2024/media/photos/821/dsc_0017_7625856512_o_large.jpg',
            '/assets/img/2024/media/photos/652/dsc_1640-copy_8163742640_o_large.jpg',
            '/assets/img/2024/media/photos/642/iiyama-autumn-bike_8187292286_o_large.jpg',
            '/assets/img/2024/media/photos/1995/DSC_0714_copy_large.jpg',
            '/assets/img/2024/media/photos/1447/sakae-mura-nagano_562686355_o_large.jpg',
            '/assets/img/2024/media/photos/1442/sakae-mura-nagano_562675935_o_large.jpg',
            '/assets/img/2024/media/photos/661/sakae-mura-nagano_562272876_o_large.jpg',
            '/assets/img/2024/media/photos/1617/dsc_9034-copy_3995347190_o_large.jpg',
            '/assets/img/2024/media/photos/1388/dsc_5306jpg_152384952_o_large.jpg',
            '/assets/img/2024/media/photos/820/dsc_0094_7625837846_o_large.jpg',
            '/assets/img/2024/media/photos/775/dsc_0046-copy_6136357381_o_large.jpg',
            '/assets/img/2024/media/photos/2315/dsc_2376_8219824595_o_large.jpg',
            '/assets/img/2024/media/photos/1856/dsc_2539_8220935640_o_large.jpg',
            '/assets/img/2024/media/photos/1860/dsc_2433_8219831013_o_large.jpg',
        ];

        const cycleImages = cyclePaths.map((p) => baseHost + p);
        // 2) Hook up each card's <img> to cycle:
        document.querySelectorAll('.landing-page-cards .info-item .info-image').forEach((img) => {
            img._cycleIndex = 0;
            img.style.cursor = 'pointer'; // show it's clickable
            img.addEventListener('click', () => {
                img._cycleIndex = (img._cycleIndex + 1) % cycleImages.length;
                img.src = cycleImages[img._cycleIndex];

                // inside your DOMContentLoaded…
                //FADE RANDOM START
                const images = container.querySelectorAll('.info-image');

                images.forEach((img) => {
                    img._cycleIndex = 0;
                    img.style.cursor = 'pointer';

                    img.addEventListener('click', () => {
                        // pick a new random index ≠ current
                        let next;
                        do {
                            next = Math.floor(Math.random() * cycleImages.length);
                        } while (next === img._cycleIndex);
                        img._cycleIndex = next;
                        const newSrc = cycleImages[next];

                        // fade out…
                        img.style.opacity = 0;

                        // once faded out, swap src and fade back in
                        const onFadeOut = (e) => {
                            if (e.propertyName !== 'opacity') return;
                            img.removeEventListener('transitionend', onFadeOut);
                            img.src = newSrc;
                            // force a frame so the browser picks up the new src at 0 opacity
                            requestAnimationFrame(() => {
                                img.style.opacity = 1;
                            });
                        };
                        img.addEventListener('transitionend', onFadeOut);
                    });
                });
                //FADE RANDOM END
            });
        });
    });
</script> -->

<style lang="scss">
    @use '../styles/global' as *;
    // .landing-page-cards {
    //     display: grid; /* Use CSS Grid */
    //     grid-template-columns: repeat(3, 1fr); /* 3 columns on large screens */
    //     gap: 30px;
    //     margin-top: 40px;
    //     width: 100%;
    // }

    // .info-item {
    //     background-color: #fff;
    //     border: 1px solid #ddd;
    //     border-radius: 8px;
    //     padding: 15px;
    //     text-align: center;
    //     box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    // }

    // .info-image {
    //     width: 100%;
    //     height: auto;
    //     border-radius: 8px;
    //     object-fit: cover;
    //     margin-bottom: 20px;
    // }

    // .info-item h2 {
    //     font-size: 1.5rem;
    //     font-weight: bold;
    //     color: #333;
    //     margin-bottom: 15px;
    // }

    // .info-item p {
    //     font-size: 1rem;
    //     color: #666;
    //     line-height: 1.6;
    // }

    // /* Responsive Layout */
    // @media (max-width: 1200px) {
    //     .landing-page-cards {
    //         grid-template-columns: repeat(2, 1fr); /* 2 columns on medium screens */
    //         gap: 20px;
    //     }
    // }

    // @media (max-width: 768px) {
    //     .landing-page-cards {
    //         grid-template-columns: 1fr; /* 1 column on smaller screens */
    //         gap: 15px;
    //     }
    // }

    .info-image {
        width: 100%;
        height: auto;
        border-radius: 8px;
        object-fit: cover;
        margin-bottom: 20px;
        transition: opacity 0.5s ease; /* <— add this */
        opacity: 1; /* ensure starting at full opacity */
    }
    .info-item {
        position: relative;
        overflow: hidden; /* clip the pseudo */
    }

    .info-item::before {
        content: '';
        position: absolute;
        inset: 0;
        background-image: var(--next-image);
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        opacity: 0;
        transition: opacity 0.6s ease;
        z-index: 1;
    }

    .info-item.fade::before {
        opacity: 1;
    }

    .info-image {
        display: block;
        width: 100%;
        height: auto;
        object-fit: cover;
        transition: opacity 0.6s ease;
        position: relative;
        z-index: 0;
        opacity: 1;
    }

    .landing-page-cards {
        display: grid; /* Use CSS Grid */
        grid-template-columns: repeat(3, 1fr); /* 3 columns on large screens */
        gap: 30px;
        margin-top: 40px;
        width: 100%;
        grid-auto-flow: row; /* Ensure items are arranged in rows */
        @include respond-to(small) {
            // padding: 10px;
            // width: 50%;
        }
    }

    /* Style for individual info items */
    .info-item {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .info-image {
        width: 100%;
        height: auto;
        border-radius: 8px;
        object-fit: cover;
        margin-bottom: 20px;
    }

    .info-item h2 {
        font-size: 1.5rem;
        font-weight: bold;
        color: #333;
        margin-bottom: 15px;
    }

    .info-item p {
        font-size: 1rem;
        color: #666;
        line-height: 1.6;
    }

    /* Responsive Layout */
    @media (max-width: 1200px) {
        .landing-page-cards {
            grid-template-columns: repeat(2, 1fr); /* 2 columns on medium screens */
            gap: 20px;
        }
    }

    @media (max-width: 768px) {
        .landing-page-cards {
            grid-template-columns: 1fr; /* 1 column on smaller screens */
            gap: 15px;
        }

        /* This places the middle card at the top of the grid when on smaller screens */
        .landing-page-cards .info-item:nth-child(2) {
            grid-row: 1; /* Place the second card in the first row */
        }
    }

    .image-container {
        position: relative;
        /* choose one of these: */

        /* A) Fixed height: */
        height: 250px; /* or whatever constant height you need */
        width: 100%;
        overflow: hidden;

        /* ——— or ——— */

        /* B) Aspect‐ratio (keeps it proportional to width): */
        /* aspect-ratio: 16 / 9; */
        /* width: 100%; */
        /* overflow: hidden; */
    }

    .image-container::before {
        /* no change here except ensure it covers the same area: */
        position: absolute;
        inset: 0;
        background-image: var(--next-image);
        background-size: cover; /* crop to fill */
        background-position: center; /* center the crop */
        background-repeat: no-repeat;
        opacity: 0;
        transition: opacity 0.6s ease;
        z-index: 1;
    }

    .image-container.fade::before {
        opacity: 1;
    }

    .info-image {
        /* fill the container, but crop any overflow */
        width: 100%;
        height: 250px;
        object-fit: cover; /* fill & crop */
        transition: opacity 0.6s ease;
        position: relative;
        z-index: 0;
        opacity: 1;
    }
</style>
